"use strict";(self.webpackChunkdatenschmutz_docs=self.webpackChunkdatenschmutz_docs||[]).push([[5282],{4137:(e,a,t)=>{t.d(a,{Zo:()=>d,kt:()=>b});var n=t(7294);function i(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function l(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function r(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?l(Object(t),!0).forEach((function(a){i(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function s(e,a){if(null==e)return{};var t,n,i=function(e,a){if(null==e)return{};var t,n,i={},l=Object.keys(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||(i[t]=e[t]);return i}(e,a);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var o=n.createContext({}),u=function(e){var a=n.useContext(o),t=a;return e&&(t="function"==typeof e?e(a):r(r({},a),e)),t},d=function(e){var a=u(e.components);return n.createElement(o.Provider,{value:a},e.children)},c={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},p=n.forwardRef((function(e,a){var t=e.components,i=e.mdxType,l=e.originalType,o=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=u(t),b=i,f=p["".concat(o,".").concat(b)]||p[b]||c[b]||l;return t?n.createElement(f,r(r({ref:a},d),{},{components:t})):n.createElement(f,r({ref:a},d))}));function b(e,a){var t=arguments,i=a&&a.mdxType;if("string"==typeof e||i){var l=t.length,r=new Array(l);r[0]=p;var s={};for(var o in a)hasOwnProperty.call(a,o)&&(s[o]=a[o]);s.originalType=e,s.mdxType="string"==typeof e?e:i,r[1]=s;for(var u=2;u<l;u++)r[u]=t[u];return n.createElement.apply(null,r)}return n.createElement.apply(null,t)}p.displayName="MDXCreateElement"},9414:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>o,contentTitle:()=>r,default:()=>c,frontMatter:()=>l,metadata:()=>s,toc:()=>u});var n=t(7462),i=(t(7294),t(4137));const l={sidebar_position:7,sidebar_label:"Setup Fail2ban",id:"fail2ban-setup",description:"This guide explains how to setup Fail2ban on Linux",slug:"/fail2ban-setup",last_update:{author:"Fabian",date:"12/21/2022"},tags:["Guide","Linux","SSH","Terminal","Fail2ban","Security"]},r="Secure SSH server under Linux with Fail2ban",s={unversionedId:"guides/fail2ban-setup",id:"guides/fail2ban-setup",title:"Secure SSH server under Linux with Fail2ban",description:"This guide explains how to setup Fail2ban on Linux",source:"@site/docs/guides/fail2ban-setup.md",sourceDirName:"guides",slug:"/fail2ban-setup",permalink:"/docs/fail2ban-setup",draft:!1,editUrl:"https://github.com/datenschmutz/docs/tree/main/docs/guides/fail2ban-setup.md",tags:[{label:"Guide",permalink:"/docs/tags/guide"},{label:"Linux",permalink:"/docs/tags/linux"},{label:"SSH",permalink:"/docs/tags/ssh"},{label:"Terminal",permalink:"/docs/tags/terminal"},{label:"Fail2ban",permalink:"/docs/tags/fail-2-ban"},{label:"Security",permalink:"/docs/tags/security"}],version:"current",lastUpdatedBy:"Fabian",lastUpdatedAt:1671580800,formattedLastUpdatedAt:"Dec 21, 2022",sidebarPosition:7,frontMatter:{sidebar_position:7,sidebar_label:"Setup Fail2ban",id:"fail2ban-setup",description:"This guide explains how to setup Fail2ban on Linux",slug:"/fail2ban-setup",last_update:{author:"Fabian",date:"12/21/2022"},tags:["Guide","Linux","SSH","Terminal","Fail2ban","Security"]},sidebar:"tutorialSidebar",previous:{title:"Change Webserver home directory",permalink:"/docs/linux-webserver-home-dir"},next:{title:"Markdown Guide",permalink:"/docs/markdown-guide"}},o={},u=[{value:"Installation",id:"installation",level:2},{value:"Update Server",id:"update-server",level:3},{value:"Install Fail2ban",id:"install-fail2ban",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Copy Configuration file",id:"copy-configuration-file",level:3},{value:"Edit Conffigurtaion file",id:"edit-conffigurtaion-file",level:3},{value:"Restart Fail2ban Service",id:"restart-fail2ban-service",level:3},{value:"Start Fail2ban",id:"start-fail2ban",level:3},{value:"Check Fail2ban status",id:"check-fail2ban-status",level:2},{value:"List banned IPs",id:"list-banned-ips",level:3},{value:"That&#39;s it! You should now have Fail2ban configured to protect your SSH server from unauthorized access attempts.",id:"thats-it-you-should-now-have-fail2ban-configured-to-protect-your-ssh-server-from-unauthorized-access-attempts",level:4}],d={toc:u};function c(e){let{components:a,...t}=e;return(0,i.kt)("wrapper",(0,n.Z)({},d,t,{components:a,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"secure-ssh-server-under-linux-with-fail2ban"},"Secure SSH server under Linux with Fail2ban"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"./fail2ban"},"Fail2ban")," protects your SSH server from unauthorized access attempts. It will monitor the log files and block any IP addresses that show signs of malicious activity, helping to keep your server secure."),(0,i.kt)("h2",{id:"installation"},"Installation"),(0,i.kt)("h3",{id:"update-server"},"Update Server"),(0,i.kt)("p",null,"Make sure that your system is up to date by running the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt update && sudo apt upgrade -y\n")),(0,i.kt)("h3",{id:"install-fail2ban"},"Install Fail2ban"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt install fail2ban\n")),(0,i.kt)("h2",{id:"configuration"},"Configuration"),(0,i.kt)("h3",{id:"copy-configuration-file"},"Copy Configuration file"),(0,i.kt)("p",null,"Copy the default Fail2ban configuration file to a new file so that you can edit:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local\n")),(0,i.kt)("h3",{id:"edit-conffigurtaion-file"},"Edit Conffigurtaion file"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo nano /etc/fail2ban/jail.local\n")),(0,i.kt)("p",null,"Scroll down to the ","[sshd]"," section and modify the enabled setting to true:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"[sshd]\n# highlight-next-line\nenabled = true\nmaxretry  = 3\nfindtime  = 1d\nbantime   = 4w\nignoreip  = 127.0.0.1/8 23.34.45.56\n")),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Save the configuration file with",(0,i.kt)("inlineCode",{parentName:"p"}," CTRL + X")," followed by ",(0,i.kt)("inlineCode",{parentName:"p"},"Y")," close with ",(0,i.kt)("inlineCode",{parentName:"p"},"RETURN"),".")),(0,i.kt)("h3",{id:"restart-fail2ban-service"},"Restart Fail2ban Service"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo systemctl restart fail2ban\n")),(0,i.kt)("h3",{id:"start-fail2ban"},"Start Fail2ban"),(0,i.kt)("p",null,"To ensure that Fail2ban starts automatically when the system boots up, run the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo systemctl enable fail2ban\n")),(0,i.kt)("h2",{id:"check-fail2ban-status"},"Check Fail2ban status"),(0,i.kt)("p",null,"This will show you the status of all the jail services that are enabled, including the sshd jail."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo systemctl status fail2ban\n")),(0,i.kt)("p",null,"Response should look like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"user@datenschmutz:~# sudo systemctl status fail2ban\n\u25cf fail2ban.service - Fail2Ban Service\n     Loaded: loaded (/lib/systemd/system/fail2ban.service; enabled; vendor pres>\n    Drop-In: /usr/lib/systemd/system/fail2ban.service.d\n             \u2514\u250050-ensure-log.conf\n     Active: active (running) since Wed 2022-09-28 12:23:48 CEST; 2 months 23 d>\n       Docs: man:fail2ban(1)\n   Main PID: 1331502 (fail2ban-server)\n      Tasks: 25 (limit: 9485)\n     Memory: 47.0M\n     CGroup: /system.slice/fail2ban.service\n             \u2514\u25001331502 /usr/bin/python2 /usr/bin/fail2ban-server -xf start\n")),(0,i.kt)("h3",{id:"list-banned-ips"},"List banned IPs"),(0,i.kt)("p",null,"To see a list of IP addresses that have been banned by Fail2ban, run the following command:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"sudo fail2ban-client statussshd\n")),(0,i.kt)("p",null,"This will show you a list of IP addresses that have been banned due to failed login attempts."),(0,i.kt)("h4",{id:"thats-it-you-should-now-have-fail2ban-configured-to-protect-your-ssh-server-from-unauthorized-access-attempts"},"That's it! You should now have Fail2ban configured to protect your SSH server from unauthorized access attempts."))}c.isMDXComponent=!0}}]);